{% extends 'base.html.twig' %}

{% block title %}Enregistrement nouveau membre{% endblock %}

{% block stylesheet %}
	{{ parent() }}
	<style type="text/css">
		.profile-user-img {
			width: 125px;
			box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.12);
		}
		.avatar-upload {
			position: relative;
			max-width: 205px;
			margin: auto;
			margin-bottom: 20px;
		}
		.avatar-upload .avatar-edit {
			position: absolute;
			right: 40px;
			z-index: 1;
			top: 90px;
		}
		.avatar-upload .avatar-edit input {
			display: none;
		}
		.avatar-upload .avatar-edit input + label {
			display: inline-block;
			width: 34px;
			height: 34px;
			margin-bottom: 0;
			border-radius: 100%;
			background: #ffffff;
			border: 1px solid #d2d6de;
			box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.12);
			cursor: pointer;
			font-weight: normal;
			transition: all 0.2s ease-in-out;
		}
		.avatar-upload .avatar-edit input + label:hover {
			background: #f1f1f1;
			border-color: #d6d6d6;
		}
		.avatar-upload .avatar-edit input + label:after {
			content: "";
			font-family: "FontAwesome";
			color: #337ab7;
			position: absolute;
			left: 0;
			right: 0;
			text-align: center;
			line-height: 34px;
			margin: auto;
		}
	</style>
{% endblock %}

{% block body %}
<!-- **************** MAIN CONTENT START **************** -->
<main>
	<section class="p-0 d-flex justify-content-center align-items-center position-relative overflow-hidden">
		<div class="container">
			<div class="card my-4 bg-light rounded-0">
				<div class="card-header">
					<!-- Title -->
					<h3>Formulaire d'adhésion nouveau membre</h3>
					<p class="lead mb-4">Veuilez fournir vos informations.</p>
				</div>
				<div class="card-body">

					{{ form_start(registrationForm) }}
					{% if error is defined %}
						<div class="alert alert-danger">
							{{ error.messageKey|trans(error.messageData, 'security') }}
						</div>
					{% endif %}
					<div class="row p-4">

						<!-- START PHOTO UPLOAD -->
						<div class="col-md-3">
							<label for="registration_form_photo">
								<img id="imagePreview" src="{{ asset('assets/images/avatar/avatar.jpg') }}" alt="" width="150" class="rounded-circle">
								<span class="d-block position-relative text-dark" style="top:-20px;left:100px"><i class="fa fa-camera fa-2x"></i></span>
								{{ form_widget(registrationForm.photo, {'attr': {'class': 'visually-hidden', 'id': 'registration_form_photo'}}) }}
								<span>Télécharger votre photo</span>
							</label>
						</div>
						<!-- END PHOTO UPLOAD -->

						<!-- START FIELDS -->
						<div class="col-md-9">
							<div class="row mb-3">
								<div class="col-md-6">
									<div class="inpt-form-group">
										<label for="firstName">{{ form_label(registrationForm.firstname) }}*</label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.firstname, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="inpt-form-group">
										<label for="lastName">{{ form_label(registrationForm.lastname) }}*</label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.lastname, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="row mb-3">
								<div class="col-md-4">
									<div class="inpt-form-group">
										<label for="lastName">{{ form_label(registrationForm.sex) }} : </label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.sex , {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
								<div class="col-md-6">
									<div class="inpt-form-group">
										<label for="lastName">{{ form_label(registrationForm.nationality) }}*</label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.nationality, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="row mb-3">
								<div class="col-md-7">
									<div class="inpt-form-group">
										<label for="email">{{ form_label(registrationForm.phoneNumber) }}*</label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.phoneNumber, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="row mb-3">
								<div class="col-md-7">
									<div class="inpt-form-group">
										<label for="email">{{ form_label(registrationForm.dateofBirth) }}</label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.dateofBirth, {'attr': {'class': 'form-control-sm js-datepicker required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="row mb-3">
								<div class="col-md-7">
									<div class="inpt-form-group">
										<label for="email">{{ form_label(registrationForm.email) }}*</label>
										<div class="inpt-group">
											{{ form_widget(registrationForm.email, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="row mb-3">
								<div class="col-md-7">
									<div class="inpt-form-group">
										<div class="inpt-group">
											{{ form_widget(registrationForm.password, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="row mb-5">
								<div class="col-md-7">
									<div class="inpt-form-group">
										<div class="inpt-group">
											{{ form_widget(registrationForm.agreeTerms, {'attr': {'class': 'inpt-control required'}}) }}
										</div>
									</div>
								</div>
							</div>
							<div class="mt-4">
								<input type="submit" value="Procéder au paiement" class="btn btn-success rounded-0 text-uppercase" id="btn-register">
							</div>
						</div>
						<!-- END FIELDS -->

					</div>
					{{ form_end(registrationForm) }}
				</div>
			</div>
		</div>
	</section>
</main>
<!-- **************** MAIN CONTENT END **************** -->
{% endblock %}

{% block javascript %}
  {{ parent() }}
    <script>
		$('document').ready(function() {
			$("#registration_form_photo").change(function(data){
				var imageFile = data.target.files[0];
				var reader = new FileReader();
				reader.readAsDataURL(imageFile);

				reader.onload = function(evt){
					$('#imagePreview').attr('src', evt.target.result);
					$('#imagePreview').hide();
					$('#imagePreview').fadeIn(650);
				}
        	});

			/*
					$("#btn-register").on("click", function(e) {

						var form = $("#registration_form");

						// you can't pass Jquery form it has to be javascript form object
						var formData = new FormData(form[0]);

						//if you only need to upload files then
						//Grab the File upload control and append each file manually to FormData
						var files = form.find("#registration_form_photo")[0].files;

						$.each(files, function() {
						  var file = $(this);
						  formData.append(file[0].name, file[0]);
						});

						if ($(form).valid()) {
							$.ajax({
								type: "POST",
								url: $(form).prop("action"),
								//dataType: 'json', //not sure but works for me without this
								data: formData,
								contentType: false, //this is requireded please see answers above
								processData: false, //this is requireded please see answers above
								//cache: false, //not sure but works for me without this
								error   : function(d){},
								success : function(d){
									console.log("");
								}
							});
						}
					});

			 */
		});

	</script>
{% endblock %}